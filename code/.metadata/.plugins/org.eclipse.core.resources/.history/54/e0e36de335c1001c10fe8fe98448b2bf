package day13;

import java.io.BufferedReader; 
import java.io.BufferedWriter; 
import java.io.IOException; 
import java.io.InputStreamReader; 
import java.io.OutputStreamWriter; 
import java.net.InetAddress; 
import java.net.ServerSocket; 
import java.net.Socket; 
 
public class ChatServerThread { 
     
    private Socket socket=null; 
    private ServerSocket server = null; 
    public void serverStart(){ 
        System.out.println("접속자를 기다리는 중입니다."); 
        try { 
            server = new ServerSocket(2007); 
            socket = server.accept(); 
             
            InetAddress ia = socket.getInetAddress(); 
            int port = socket.getLocalPort();// 접속에 사용된 PORT  
            String ip = ia.getHostAddress(); // 원격 Client IP  
             
            System.out.print("클라이언트 접속-Local Port: "+ port); 
            System.out.println(" Client IP: " + ip); 
             
            //데이터를 읽어오는 스레드 
            ChatServerReadHandler read = new ChatServerReadHandler(socket); 
            read.start(); 
            //데이터를 보내는 스레드 
            ChatServerSendHandler send = new ChatServerSendHandler(socket); 
            send.start(); 
        } catch(IOException ioe) { 
            System.err.println("연결이 되어 있지 않습니다."); 
        } finally { 
            try { 
                server.close(); 
            } catch(IOException ignored) {} 
        } 
         
    } 
 
    public static void main(String[] args) { 
        ChatServerThread cs = new ChatServerThread(); 
        cs.serverStart(); 
    } 
} 
