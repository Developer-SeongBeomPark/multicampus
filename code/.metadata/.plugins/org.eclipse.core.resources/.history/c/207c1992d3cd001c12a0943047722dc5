package exam;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class BookDAO {
  public boolean create(BookDTO dto) {
    boolean flag = false;
    
    Connection con = DBOpen.open();
    PreparedStatement pstmt = null;
    
    StringBuffer sql = new StringBuffer();
    sql.append(" insert into book values(?, ?, ?, ? ,? ,? ,?) ");
    
    try {
      pstmt = con.prepareStatement(sql.toString());
      
      pstmt.setInt(1, dto.getIsbn());
      pstmt.setString(2, dto.getTitle());
      pstmt.setString(3, dto.getAuthor());
      pstmt.setString(4, dto.getPublisher());
      pstmt.setInt(5, dto.getPrice());
      pstmt.setString(6, dto.getDes());
      pstmt.setDate(7, dto.getDate());
      
      int cnt = pstmt.executeUpdate();
      if(cnt > 0) flag = true;
      
      
      
    } catch (SQLException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    } finally {
      DBClose.close(con, pstmt);
    }
    
    return flag;
  }
  
  public static boolean update(int price, int isbn) {
    boolean flag = false;
    
    Connection con = DBOpen.open();
    PreparedStatement pstmt = null;
    
    StringBuffer sql = new StringBuffer();
    sql.append(" update book ");
    sql.append(" set price = ? ");
    sql.append(" where isbn = ? ");
    
    try {
      pstmt = con.prepareStatement(sql.toString());
      pstmt.setInt(15000, isbn);
      
    } catch (SQLException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }
    
    
    return flag;
  }
}
